<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lighthouse: Advocacy for Mental Wellness</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Font - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <!-- Load Phosphor Icons for simple visuals -->
    <script src="https://unpkg.com/phosphor-icons"></script>
    <style>
        /* Custom styles to ensure the Inter font is used everywhere */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb; /* Very light cool background */
            scroll-behavior: smooth;
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #8b5cf6; /* Purple-500 */
            border-radius: 10px;
        }
        /* Style for the 'Get Help' button hover effect */
        .cta-button {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.4);
        }
        .card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        /* Make hospital/support lists scrollable and ensure black text for readability */
        .hospital-list-scroll { max-height: 40vh; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .support-list-item, #support-hospitals div { color: #000000; }
    </style>
    <script>
        // Simple client-side script for navigation
        function navigate(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // Simple script to toggle mobile menu
        function toggleMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // Close overlays and go to home (used by logo and Home links)
        function goHome() {
            try {
                // Hide modals/overlays if open
                const immediate = document.getElementById('immediate-modal'); if (immediate) immediate.classList.add('hidden');
                const support = document.getElementById('support-page'); if (support) support.classList.add('hidden');
                const share = document.getElementById('share-modal'); if (share) share.classList.add('hidden');
                // Restore body scroll if it was locked
                document.body.style.overflow = '';
                // Navigate to top / home section
                navigate('home');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } catch (e) { console.warn('goHome error', e); }
        }
    </script>
</head>
<body class="text-gray-800">

    <!-- Header / Navigation Bar -->
    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <!-- Logo/Brand -->
                <a href="#" onclick="goHome(); return false;" class="flex items-center space-x-2 text-xl font-extrabold text-purple-600">
                    <i class="ph-lighthouse text-2xl"></i>
                    <span>Lighthouse</span>
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex space-x-8">
                    <a href="#" onclick="goHome(); return false;" class="text-gray-600 hover:text-purple-600 transition duration-150">Home</a>
                    <a href="#" onclick="navigate('about')" class="text-gray-600 hover:text-purple-600 transition duration-150">Vision & Mission</a>
                    <a href="#" onclick="navigate('resources')" class="text-gray-600 hover:text-purple-600 transition duration-150">Resources</a>
                </nav>

                <!-- Get Help Button -->
                <a href="#" onclick="openImmediate();" class="hidden md:block bg-purple-600 text-white py-2 px-4 rounded-full font-semibold hover:bg-purple-700 transition duration-300 shadow-lg shadow-purple-200">
                    Get Help Now
                </a>

                <!-- Mobile Menu Button -->
                <button class="md:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100" onclick="toggleMenu()">
                    <i class="ph-list text-2xl"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu Dropdown -->
            <div id="mobile-menu" class="hidden md:hidden px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-white">
            <a href="#" onclick="goHome(); toggleMenu(); return false;" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50">Home</a>
            <a href="#" onclick="navigate('about'); toggleMenu();" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50">Vision & Mission</a>
            <a href="#" onclick="navigate('resources'); toggleMenu();" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50">Resources</a>
            <a href="#" onclick="openImmediate(); toggleMenu();" class="block px-3 py-2 rounded-md text-base font-medium bg-purple-500 text-white text-center hover:bg-purple-600">Get Help Now</a>
        </div>
    </header>
    
    <main class="py-12">
        <!-- 1. Hero Section -->
        <section id="home" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center pt-10 pb-16">
            <div class="bg-indigo-50 p-6 sm:p-12 rounded-3xl">
                <h1 class="text-4xl sm:text-6xl font-extrabold tracking-tight text-indigo-800 leading-tight mb-4">
                    You Are Not Alone.
                </h1>
                <p class="mt-4 text-xl text-indigo-600 max-w-3xl mx-auto">
                    A safe space to understand the challenges of Anxiety and Depression, and connect with the support you need to move forward.
                </p>
                <div class="mt-8 flex justify-center space-x-4">
                    <a href="#" onclick="navigate('resources')" class="cta-button bg-purple-600 text-white text-lg font-bold py-3 px-8 rounded-full shadow-xl hover:bg-purple-700 transition duration-300">
                        Explore Resources
                    </a>
                    <a href="#" onclick="window.open('https://m.me/','_blank')" class="cta-button bg-transparent border-2 border-purple-600 text-purple-600 text-lg font-bold py-3 px-8 rounded-full hover:bg-purple-50 transition duration-300">
                        Talk to Someone
                    </a>
                </div>
            </div>
        </section>

        <!-- 2. Core Message / Dual Challenge -->
        <section id="about" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <h2 class="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-4">Vision & Mission</h2>
            <p class="text-lg text-center text-gray-700 mb-6 max-w-3xl mx-auto">
                <strong>Vision:</strong> This website envision the awareness of anxiety and depression, helping people who struggles expressing themselves. This aims to be the voice and connection for love ones to prevent the increasing amount of suicides specially for teenagers. Promoting hope for a fresh a new start and be an inspiration to keep going.
            </p>
            <p class="text-lg text-center text-gray-700 mb-10 max-w-3xl mx-auto">
                <strong>Mission:</strong> Our campaign aims to empower individuals to take charge of their mental well-being and discover their passions by promoting education and awareness about mental health, ultimately providing support to those who are struggling and helping them shift away from negative thoughts.
            </p>
            <h3 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-12">The Dual Challenge: Understanding Anxiety and Depression</h3>
            <div class="grid md:grid-cols-2 gap-8 lg:gap-12">
                
                <!-- Anxiety Card -->
                <div class="card bg-white p-6 sm:p-8 rounded-xl border border-blue-100">
                    <div class="flex items-center space-x-4 mb-4">
                        <i class="ph-lightning text-4xl text-blue-500"></i>
                        <h3 class="text-2xl font-semibold text-blue-700">Anxiety: The Overwhelmed Mind</h3>
                    </div>
                    <p class="text-gray-600 leading-relaxed">
                        Anxiety is more than just stress. It's a persistent, excessive worry that interferes with daily life. It can manifest physically as a racing heart, shallow breath, or feeling constantly on edge. It's the mind spinning forward, anticipating worst-case scenarios and making the present moment feel unsafe.
                    </p>
                    <p class="mt-4 text-sm text-blue-500 font-medium">#Grounding #CopingSkills #Mindfulness</p>
                </div>

                <!-- Depression Card -->
                <div class="card bg-white p-6 sm:p-8 rounded-xl border border-purple-100">
                    <div class="flex items-center space-x-4 mb-4">
                        <i class="ph-cloud-rain text-4xl text-purple-500"></i>
                        <h3 class="text-2xl font-semibold text-purple-700">Depression: The Weight of Emptiness</h3>
                    </div>
                    <p class="text-gray-600 leading-relaxed">
                        Depression is a persistent feeling of sadness and loss of interest. It's an internal weight that saps energy, motivation, and joy. It can affect sleep, appetite, and concentration, making even small tasks feel insurmountable. It's the mind sinking down, viewing the past and future with overwhelming hopelessness.
                    </p>
                    <p class="mt-4 text-sm text-purple-500 font-medium">#Compassion #Connection #ProfessionalHelp</p>
                </div>
            </div>
        </section>

        <!-- 3. Statistics and Encouragement -->
        <section class="bg-purple-600 py-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-white text-center">
                <h2 class="text-3xl sm:text-4xl font-extrabold mb-4">Recovery Is Possible. Healing Is Real.</h2>
                <p class="text-lg mb-10 opacity-90">These challenges are common, treatable, and not a sign of weakness.</p>
                
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-8">
                    <!-- Stat 1 -->
                    <div class="p-6 bg-purple-700 rounded-xl">
                        <i class="ph-heart-straight text-4xl mb-3 text-pink-300"></i>
                        <p class="text-4xl font-bold">1 in 5</p>
                        <p class="mt-2 text-sm opacity-80">Adults experience a mental illness in a given year.</p>
                    </div>
                    <!-- Stat 2 -->
                    <div class="p-6 bg-purple-700 rounded-xl">
                        <i class="ph-lightbulb text-4xl mb-3 text-yellow-300"></i>
                        <p class="text-4xl font-bold">80%</p>
                        <p class="mt-2 text-sm opacity-80">Of people treated for depression show improvement.</p>
                    </div>
                    <!-- Stat 3 -->
                    <div class="p-6 bg-purple-700 rounded-xl">
                        <i class="ph-users text-4xl mb-3 text-teal-300"></i>
                        <p class="text-4xl font-bold">We See You</p>
                        <p class="mt-2 text-sm opacity-80">A community ready to support your journey.</p>
                    </div>
                </div>
                <!-- Latest stats block -->
                <div class="mt-10 text-left max-w-3xl mx-auto bg-white bg-opacity-10 p-4 rounded">
                    <h3 class="text-lg font-semibold">Latest statistics (authoritative sources)</h3>
                    <ul class="mt-2 text-sm leading-relaxed">
                        <li><strong>Prevalence:</strong> Approximately 1 in 8 people worldwide experienced a mental disorder in 2021 (Global Burden of Disease estimates). <span class="opacity-80">Source: <a href="https://www.thelancet.com/" target="_blank" class="underline">Global Burden of Disease / Lancet</a></span></li>
                        <li class="mt-1"><strong>Suicide deaths:</strong> Over 700,000 deaths by suicide occur each year globally (WHO). <span class="opacity-80">Source: <a href="https://www.who.int/news-room/fact-sheets/detail/suicide" target="_blank" class="underline">WHO - Suicide</a></span></li>
                        <li class="mt-1"><strong>Treatment effectiveness:</strong> Many mental health conditions are treatable — for example, most people treated for depression improve with psychotherapy, medication, or both. <span class="opacity-80">Source: <a href="https://www.nimh.nih.gov/health/topics/depression" target="_blank" class="underline">NIMH</a></span></li>
                        <li class="mt-1"><strong>Philippines:</strong> The Philippines has been strengthening national mental health services, including crisis hotlines and community programs — local access varies by region. For national support, see the NCMH and Hopeline. <span class="opacity-80">Source: <a href="https://ncmh.gov.ph/" target="_blank" class="underline">NCMH Philippines</a></span></li>
                    </ul>
                    <p class="mt-2 text-xs opacity-80">Note: statistics vary by year and data source; for the most recent national or global figures consult the linked sources.</p>
                </div>
            </div>
        </section>

        <!-- 4. Resources Section -->
        <section id="resources" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <h2 class="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-12">Essential Tools and Resources</h2>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Resource 1: Professional Help -->
                <div class="card bg-white p-6 rounded-xl border border-gray-100">
                    <i class="ph-chats text-4xl text-green-600 mb-3"></i>
                    <h3 class="text-xl font-semibold mb-2">Talk to a Therapist</h3>
                    <p class="text-gray-600 text-sm mb-4">
                        Professional guidance can provide proven strategies and a confidential space to process feelings.
                    </p>
                    <button onclick="showResource('therapist')" class="text-green-600 font-medium hover:text-green-700 flex items-center focus:outline-none">
                        Find a Local Provider <i class="ph-arrow-right ml-2"></i>
                    </button>
                    <ul id="therapist-list" class="mt-4 text-left text-sm text-gray-700 hidden bg-green-50 rounded-lg p-4">
                        <li><strong>National Center for Mental Health (NCMH) Outpatient Clinic</strong> – Bagong Olongapo St, Manila; Tel: <a href="tel:+6328527-7638" class="text-blue-600">(02) 8527-7638</a></li>
                        <li><strong>Philippine Mental Health Association (PMHA) Counseling Services</strong> – 3/F PMHA Bldg, Manila; Tel: <a href="tel:+6328523-7076" class="text-blue-600">(02) 8523-7076</a></li>
                        <li><strong>UP Health Service - Mental Health Unit</strong> – University of the Philippines, Diliman, Quezon City; Tel: <a href="tel:+6328992-5522" class="text-blue-600">(02) 8992-5522</a></li>
                        <li><strong>Philippine Mental Health Specialists (Private Clinic)</strong> – Makati City; Tel: <a href="tel:+6328899-1234" class="text-blue-600">(02) 8899-1234</a> (example)</li>
                    </ul>
                </div>

                <!-- Resource 2: Crisis Hotline -->
                <div class="card bg-white p-6 rounded-xl border border-gray-100">
                    <i class="ph-phone-call text-4xl text-red-600 mb-3"></i>
                    <h3 class="text-xl font-semibold mb-2">Crisis Hotline (24/7)</h3>
                    <p class="text-gray-600 text-sm mb-4">
                        If you are experiencing an emergency or immediate distress, please reach out now.
                    </p>
                    <button onclick="showResource('hotline')" class="text-red-600 font-medium hover:text-red-700 flex items-center focus:outline-none">
                        View All Hotlines <i class="ph-arrow-right ml-2"></i>
                    </button>
                    <ul id="hotline-list" class="mt-4 text-left text-sm text-gray-700 hidden bg-red-50 rounded-lg p-4">
                        <li><strong>National Center for Mental Health (NCMH) Crisis Hotline:</strong> <a href="tel:0917-899-8727" class="text-blue-600">0917-899-8727</a></li>
                        <li><strong>Hopeline (Philippines):</strong> <a href="tel:+63288046727" class="text-blue-600">02-8804-6727</a></li>
                        <li><strong>Philippine Red Cross (Emergency):</strong> <a href="tel:116-117" class="text-blue-600">116-117</a></li>
                        <li><strong>National Emergency Hotline:</strong> <a href="tel:911" class="text-blue-600">911</a></li>
                    </ul>
                </div>

                <!-- Resource 3: Self-Care & Video Resources -->
                <div class="card bg-white p-6 rounded-xl border border-gray-100">
                    <i class="ph-leaf text-4xl text-yellow-600 mb-3"></i>
                    <h3 class="text-xl font-semibold mb-2">Self-Care & Video Resources</h3>
                    <p class="text-gray-600 text-sm mb-4">
                        Short, practical videos can help in a crisis or when you're trying to support someone. These open YouTube search results (so content is always current). Tap a link to open videos in a new tab on your phone.
                    </p>
                    <ul class="text-sm text-gray-800 space-y-2 mb-3">
                        <li><a href="https://www.youtube.com/results?search_query=suicide+prevention+WHO" target="_blank" rel="noopener" class="text-blue-600 underline">Suicide prevention (WHO & authoritative sources)</a></li>
                        <li><a href="https://www.youtube.com/results?search_query=how+to+help+someone+suicidal" target="_blank" rel="noopener" class="text-blue-600 underline">How to help someone who may be suicidal (practical steps)</a></li>
                        <li><a href="https://www.youtube.com/results?search_query=grounding+exercises+for+anxiety" target="_blank" rel="noopener" class="text-blue-600 underline">Grounding & breathing exercises for anxiety</a></li>
                        <li><a href="https://www.youtube.com/results?search_query=suicide+prevention+philippines" target="_blank" rel="noopener" class="text-blue-600 underline">Philippines-specific support & stories</a></li>
                    </ul>
                    <div class="mt-2">
                        <button onclick="showResource('selfcare')" class="text-yellow-600 font-medium hover:text-yellow-700 flex items-center focus:outline-none">
                            Add Your Own Membership / Resource <i class="ph-arrow-right ml-2"></i>
                        </button>
                    </div>
                    <div id="selfcare-form" class="mt-4 hidden bg-yellow-50 rounded-lg p-4">
                        <form onsubmit="event.preventDefault(); addMembership();">
                            <label class="block mb-2 text-sm font-medium text-gray-700">Membership/Practice Name:</label>
                            <input id="membership-input" type="text" class="w-full border border-yellow-300 rounded px-2 py-1 mb-2" placeholder="e.g., Calm App, Yoga Group" required />
                            <button type="submit" class="bg-yellow-500 text-white px-4 py-1 rounded hover:bg-yellow-600">Add</button>
                        </form>
                        <ul id="membership-list" class="mt-2 text-sm text-gray-700"></ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. Final Call to Action / Help Section -->
        <section id="help" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center">
            <div class="bg-purple-100 p-8 sm:p-12 rounded-2xl border-4 border-purple-300 border-dashed">
                <h2 class="text-3xl sm:text-5xl font-extrabold text-purple-900 mb-4">Take the Next Step.</h2>
                <p class="text-xl text-purple-700 max-w-2xl mx-auto mb-8">
                    Whether it's a first step or a hundredth, reaching out is a powerful act of courage. Your wellness matters.
                </p>
                <div class="flex justify-center">
                    <a href="#" onclick="openImmediate();" class="cta-button bg-purple-600 text-white text-lg sm:text-xl font-bold py-3 px-6 sm:py-4 sm:px-10 rounded-full shadow-2xl hover:bg-purple-800 transition duration-300 inline-flex items-center justify-center w-full sm:w-auto text-center whitespace-normal">
                        <i class="ph-hand-heart mr-2"></i>
                        <span>Find Immediate Support</span>
                    </a>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="flex justify-center space-x-6 mb-4">
                <a href="#" class="text-gray-400 hover:text-purple-400 transition"><i class="ph-instagram-logo text-2xl"></i></a>
                <a href="#" class="text-gray-400 hover:text-purple-400 transition"><i class="ph-twitter-logo text-2xl"></i></a>
                <a href="#" class="text-gray-400 hover:text-purple-400 transition"><i class="ph-envelope-simple text-2xl"></i></a>
                <button onclick="openShareModal()" class="text-gray-400 hover:text-purple-400 transition flex items-center space-x-2">
                    <i class="ph-share-network text-2xl"></i>
                    <span class="text-sm">Share</span>
                </button>
            </div>
            <p class="text-sm text-gray-500">
                &copy; 2024 Lighthouse Mental Wellness Advocacy. All rights reserved.
            </p>
            <p class="text-xs text-gray-600 mt-2">
                Disclaimer: This site is for informational and educational purposes only and is not a substitute for professional medical advice or treatment.
            </p>
        </div>
        <!-- Share Modal (hidden by default) -->
        <div id="share-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 w-11/12 max-w-lg mx-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Share this page</h3>
                    <button onclick="closeShareModal()" class="text-gray-500 hover:text-gray-700 text-2xl leading-none">&times;</button>
                </div>
                <div>
                    <label class="text-sm text-gray-600">Page URL</label>
                    <div class="flex mt-2">
                        <input id="share-url" type="text" class="flex-1 border rounded px-2 py-1" readonly />
                        <button onclick="copyShareURL()" class="ml-2 bg-purple-600 text-white px-3 py-1 rounded">Copy</button>
                    </div>
                    <div class="mt-4">
                        <label class="text-sm text-gray-600">QR Code</label>
                        <div id="qrcode" class="mt-2"></div>
                        <button onclick="downloadQRCode()" class="mt-2 bg-gray-100 text-gray-800 px-3 py-1 rounded">Download QR</button>
                    </div>
                    <div class="mt-4 text-sm text-gray-700">
                        <p><strong>Open on another device in the same Wi‑Fi:</strong> If you're serving this site locally (e.g., http://localhost:3000), use the local IP below on your phone:</p>
                        <pre id="local-ips" class="bg-gray-100 p-2 rounded mt-2 text-xs">Detecting local addresses...</pre>
                        <p class="mt-3"><strong>Open from anywhere (different internet):</strong> use a tunneling service like <code>ngrok</code> or <code>localtunnel</code>. Example PowerShell commands are shown below.</p>
                        <pre class="bg-gray-100 p-2 rounded mt-2 text-xs"># Install localtunnel (Node.js required)
npm install -g localtunnel
# Expose port 3000
> lt --port 3000

# Or use ngrok (download & signin required)
> ngrok http 3000
</pre>
                    </div>
                </div>
                <div class="mt-4 text-right">
                    <button onclick="closeShareModal()" class="px-4 py-2 rounded bg-gray-200">Close</button>
                </div>
            </div>
        </div>

        <!-- QRCode library (small, client-side) -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

        <!-- Immediate Support Modal -->
        <div id="immediate-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-60">
            <div class="bg-white rounded-xl p-6 w-11/12 max-w-2xl mx-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Immediate Support</h3>
                    <button onclick="closeImmediate()" class="text-gray-500 hover:text-gray-700 text-2xl leading-none">&times;</button>
                </div>
                <p class="text-sm text-gray-700">We can try to find nearby hospitals or crisis centers and offer ways to contact them. You can also choose to share your location to find the nearest services.</p>
                <div class="mt-4 flex space-x-3">
                    <button onclick="useGeolocation()" class="bg-red-600 text-white px-4 py-2 rounded">Find Nearby Hospitals</button>
                    <button onclick="goToSupportPage()" class="bg-purple-600 text-white px-4 py-2 rounded">Open Support Page</button>
                    <button onclick="closeImmediate()" class="bg-gray-200 px-4 py-2 rounded">Close</button>
                </div>
                <div id="immediate-status" class="mt-4 text-sm text-gray-600"></div>
                <div id="hospital-list" class="mt-4 space-y-3"></div>
            </div>
        </div>

        <!-- In-page Support "page" (same document) -->
        <div id="support-page" class="fixed inset-0 bg-white hidden z-70 overflow-auto">
            <div class="max-w-3xl mx-auto p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">Immediate Support Options</h2>
                    <div>
                        <button onclick="closeSupportPage()" class="bg-gray-200 px-3 py-1 rounded">Close</button>
                    </div>
                </div>
                <p class="text-gray-700">Here you can contact local hospitals, call a crisis hotline, or add your own membership/contact for quick access.</p>

                <section class="mt-6">
                    <h3 class="font-semibold">Crisis Hotlines (Philippines)</h3>
                    <ul class="mt-2 text-sm text-gray-800">
                        <li><strong>National Center for Mental Health Crisis Hotline:</strong> Call or Text <a href="tel:0917-899-8727" class="text-blue-600">0917-899-8727</a></li>
                        <li><strong>Philippine Red Cross (Emergency):</strong> <a href="tel:116-117" class="text-blue-600">116-117</a></li>
                        <li><strong>Hopeline (National):</strong> <a href="tel:+63288046727" class="text-blue-600">02-8804-6727</a></li>
                        <li><strong>National Emergency Hotline (Police/Fire/Ambulance):</strong> <a href="tel:911" class="text-blue-600">911</a></li>
                        <li><strong>International:</strong> <a href="https://www.opencounseling.com/suicide-hotlines" target="_blank" class="text-blue-600">Find other countries</a></li>
                    </ul>
                </section>

                <section class="mt-6">
                    <h3 class="font-semibold">Nearby Hospitals</h3>
                    <div class="mt-2 hospital-list-scroll" id="support-hospitals">No location chosen. Click "Find Nearby Hospitals" in the Immediate Support popup to search.</div>
                </section>

                <section class="mt-6">
                    <h3 class="font-semibold">Your Memberships / Quick Contacts</h3>
                    <div id="quick-contacts" class="mt-2">
                        <form id="quick-contact-form" onsubmit="event.preventDefault(); addQuickContact();">
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
                                <input id="qc-name" class="border px-2 py-1 rounded col-span-2" placeholder="Name (e.g., Local Hospital)" required />
                                <input id="qc-phone" class="border px-2 py-1 rounded" placeholder="Phone (optional)" />
                            </div>
                            <div class="mt-2">
                                <button type="submit" class="bg-yellow-500 text-white px-3 py-1 rounded">Add</button>
                            </div>
                        </form>
                        <ul id="qc-list" class="mt-3 space-y-2 text-sm"></ul>
                    </div>
                </section>
            </div>
        </div>
        </div>
    </footer>
<script>
// Toggle resource lists
function showResource(type) {
    // Hide all
    document.getElementById('therapist-list').classList.add('hidden');
    document.getElementById('hotline-list').classList.add('hidden');
    document.getElementById('selfcare-form').classList.add('hidden');
    // Show selected
    if (type === 'therapist') {
        document.getElementById('therapist-list').classList.toggle('hidden');
    } else if (type === 'hotline') {
        document.getElementById('hotline-list').classList.toggle('hidden');
    } else if (type === 'selfcare') {
        document.getElementById('selfcare-form').classList.toggle('hidden');
    }
}
// Add membership to self-care list
function addMembership() {
    const input = document.getElementById('membership-input');
    const list = document.getElementById('membership-list');
    if (input.value.trim() !== '') {
        const li = document.createElement('li');
        li.textContent = input.value.trim();
        list.appendChild(li);
        input.value = '';
    }
}
</script>
<script>
// Share modal functions
function openShareModal() {
    const modal = document.getElementById('share-modal');
    modal.classList.remove('hidden');
    const urlInput = document.getElementById('share-url');
    // Use current location.href by default
    let pageUrl = location.href;
    // If served from localhost, keep localhost; otherwise keep actual URL
    urlInput.value = pageUrl;
    generateQRCode(pageUrl);
    detectLocalIPs();
}
function closeShareModal() {
    const modal = document.getElementById('share-modal');
    modal.classList.add('hidden');
}

function copyShareURL() {
    const urlInput = document.getElementById('share-url');
    urlInput.select();
    urlInput.setSelectionRange(0, 99999); // mobile
    try {
        document.execCommand('copy');
        alert('Link copied to clipboard');
    } catch (e) {
        navigator.clipboard?.writeText(urlInput.value).then(()=>alert('Link copied to clipboard'));
    }
}

let qrcodeInstance = null;
function generateQRCode(text) {
    const container = document.getElementById('qrcode');
    container.innerHTML = '';
    qrcodeInstance = new QRCode(container, {
        text: text,
        width: 160,
        height: 160,
        colorDark : '#000000',
        colorLight : '#ffffff',
        correctLevel : QRCode.CorrectLevel.H
    });
}

function downloadQRCode() {
    const container = document.getElementById('qrcode');
    const img = container.querySelector('img');
    if (img) {
        const url = img.src;
        const a = document.createElement('a');
        a.href = url;
        a.download = 'lighthouse-qr.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
    } else {
        // older canvas fallback
        const canvas = container.querySelector('canvas');
        if (canvas) {
            const url = canvas.toDataURL('image/png');
            const a = document.createElement('a');
            a.href = url;
            a.download = 'lighthouse-qr.png';
            document.body.appendChild(a);
            a.click();
            a.remove();
        } else {
            alert('QR code not found');
        }
    }
}

// Detect local IPs via WebRTC trick (best-effort, works in many browsers)
function detectLocalIPs() {
    const output = document.getElementById('local-ips');
    output.textContent = 'Detecting local addresses...';
    const ips = new Set();
    // Compatibility
    const RTCPeerConnection = window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection;
    if (!RTCPeerConnection) {
        output.textContent = 'Local IP detection not supported in this browser.';
        return;
    }
    const pc = new RTCPeerConnection({iceServers:[]});
    pc.createDataChannel('');
    pc.onicecandidate = (e) => {
        if (!e.candidate) {
            // finished
            if (ips.size === 0) output.textContent = 'No local addresses detected.';
            else output.textContent = Array.from(ips).join('\n');
            pc.close();
            return;
        }
        const parts = e.candidate.candidate.split(' ');
        for (const part of parts) {
            // IPv4/IPv6 regex
            const ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9:]+)/i;
            const m = ipRegex.exec(part);
            if (m) ips.add(m[1]);
        }
    };
    pc.createOffer().then(offer=>pc.setLocalDescription(offer)).catch(()=>{
        output.textContent = 'Could not create WebRTC offer. Local IP detection failed.';
    });
}
</script>
<script>
// Immediate Support functions
function openImmediate() {
    document.getElementById('immediate-modal').classList.remove('hidden');
}
function closeImmediate() {
    document.getElementById('immediate-modal').classList.add('hidden');
}



function useGeolocation() {
    const status = document.getElementById('immediate-status');
    status.textContent = 'Requesting location…';
    if (!navigator.geolocation) {
        status.textContent = 'Geolocation not supported by your browser.';
        return;
    }
    navigator.geolocation.getCurrentPosition(async (pos) => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        status.textContent = `Location: ${lat.toFixed(4)}, ${lon.toFixed(4)} — searching nearby hospitals...`;
        const hospitals = await findNearbyHospitals(lat, lon, 5000); // 5 km radius
        renderHospitalList(hospitals);
    }, (err) => {
        status.textContent = 'Unable to retrieve your location: ' + (err.message || err.code);
    }, {enableHighAccuracy:true, timeout:10000});
}

async function findNearbyHospitals(lat, lon, radiusMeters) {
    // Overpass QL: find amenity=hospital or emergency=hospital or healthcare=hospital
    const query = `[
out:json][timeout:10];(
  node[amenity=hospital](around:${radiusMeters},${lat},${lon});
  way[amenity=hospital](around:${radiusMeters},${lat},${lon});
  node[healthcare=hospital](around:${radiusMeters},${lat},${lon});
  way[healthcare=hospital](around:${radiusMeters},${lat},${lon});
);
out center 20;`;
    const url = 'https://overpass-api.de/api/interpreter';
    try {
        const res = await fetch(url, {method:'POST', body: query});
        const data = await res.json();
        // map elements to simple objects
        const items = data.elements.map(el => {
            const name = el.tags && (el.tags.name || el.tags['operator']) || 'Unnamed Hospital';
            const phone = el.tags && (el.tags.phone || el.tags.telephone) || '';
            const latp = el.lat || (el.center && el.center.lat);
            const lonp = el.lon || (el.center && el.center.lon);
            return {id: el.id, name, phone, lat: latp, lon: lonp, tags: el.tags || {}};
        });
        return items;
    } catch (e) {
        console.error('Overpass error', e);
        return [];
    }
}

function renderHospitalList(hospitals) {
    const container = document.getElementById('hospital-list');
    container.innerHTML = '';
    if (!hospitals || hospitals.length === 0) {
        container.innerHTML = '<div class="text-sm text-gray-600">No hospitals found nearby.</div>';
        supportHosp.textContent = 'No nearby hospitals found.';
        return;
    }
    hospitals.slice(0,10).forEach(h => {
        const div = document.createElement('div');
        div.className = 'p-3 border rounded bg-gray-50 support-list-item';
        const title = document.createElement('div');
        title.className = 'font-semibold';
        title.textContent = h.name;
        const details = document.createElement('div');
        details.className = 'text-sm text-gray-700 mt-1';
        const sanitizedPhone = (h.phone || '').replace(/[^+0-9]/g, '');
        details.innerHTML = `${h.phone ? 'Phone: <a href="tel:${sanitizedPhone}" class="text-blue-600">' + h.phone + '</a>' : 'Phone: N/A'}`;
        const actions = document.createElement('div');
        actions.className = 'mt-2 flex space-x-2';
        const callBtn = document.createElement('a');
        callBtn.href = h.phone ? `tel:${(h.phone||'').replace(/[^+0-9]/g,'')}` : '#';
        callBtn.className = 'bg-red-500 text-white px-3 py-1 rounded';
        callBtn.textContent = h.phone ? 'Call' : 'No phone';
        const mapBtn = document.createElement('a');
        mapBtn.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(h.lat + ',' + h.lon)}`;
        mapBtn.target = '_blank';
        mapBtn.className = 'bg-blue-500 text-white px-3 py-1 rounded';
        mapBtn.textContent = 'Directions';
        const copyBtn = document.createElement('button');
        copyBtn.className = 'bg-gray-200 px-3 py-1 rounded';
        copyBtn.textContent = 'Copy Contact';
        copyBtn.onclick = () => {
            const text = `${h.name}${h.phone ? ' — ' + h.phone : ''} — https://www.google.com/maps/search/?api=1&query=${h.lat},${h.lon}`;
            copyTextToClipboard(text);
            alert('Contact copied to clipboard');
        };
        actions.appendChild(callBtn);
        actions.appendChild(mapBtn);
        actions.appendChild(copyBtn);
        div.appendChild(title);
        div.appendChild(details);
        div.appendChild(actions);
        container.appendChild(div);
    });
    // Also populate the support-page section
    const supportHosp = document.getElementById('support-hospitals');
    supportHosp.innerHTML = '';
    hospitals.slice(0,6).forEach(h => {
        const li = document.createElement('div');
        li.className = 'p-2 border-b flex justify-between items-center support-list-item';
        li.innerHTML = `<div><div class="font-medium">${h.name}</div><div class="text-xs text-gray-600">${h.phone || 'Phone: N/A'}</div></div>`;
        const right = document.createElement('div');
        right.className = 'flex space-x-2';
    const call = document.createElement('a');
    call.href = h.phone ? `tel:${(h.phone||'').replace(/[^+0-9]/g,'')}` : '#';
    call.textContent = 'Call';
    call.className = 'text-white bg-red-600 px-2 py-1 rounded text-sm';
    call.onclick = (e) => { if (!h.phone) e.preventDefault(); };
        const copy = document.createElement('button');
        copy.className = 'bg-gray-200 px-2 py-1 rounded text-sm';
        copy.textContent = 'Copy';
    copy.onclick = () => { copyTextToClipboard(`${h.name} ${h.phone ? h.phone : ''}`); alert('Copied'); };
        const dir = document.createElement('a');
        dir.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(h.lat + ',' + h.lon)}`;
        dir.target = '_blank';
        dir.className = 'text-white bg-blue-600 px-2 py-1 rounded text-sm';
        dir.textContent = 'Map';
        right.appendChild(call);
        right.appendChild(copy);
        right.appendChild(dir);
        li.appendChild(right);
        supportHosp.appendChild(li);
    });
}

// When opening/closing the in-page support view, lock body scroll so background doesn't interfere
let _supportEscHandler = null;
let _previousScrollY = 0;
function goToSupportPage() {
    // ensure immediate modal closed
    closeImmediate();
    // save current scroll position so we can restore it
    _previousScrollY = window.scrollY || window.pageYOffset || 0;
    const page = document.getElementById('support-page');
    page.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    // focus first heading for accessibility
    const h = page.querySelector('h2'); if (h) h.focus = true;
    // add ESC handler to close
    _supportEscHandler = (e) => { if (e.key === 'Escape') closeSupportPage(); };
    document.addEventListener('keydown', _supportEscHandler);
}
function closeSupportPage() {
    const page = document.getElementById('support-page');
    page.classList.add('hidden');
    document.body.style.overflow = '';
    // remove ESC handler
    if (_supportEscHandler) document.removeEventListener('keydown', _supportEscHandler);
    _supportEscHandler = null;
    // ensure immediate modal hidden as well
    document.getElementById('immediate-modal').classList.add('hidden');
    // restore previous scroll position if available
    try { window.scrollTo({ top: _previousScrollY || 0, behavior: 'smooth' }); } catch (e) {}
}

function copyTextToClipboard(text) {
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).catch(()=>{
            // fallback
            const ta = document.createElement('textarea');
            ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
        });
    } else {
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
    }
}

// Quick contacts (memberships) stored in memory for this session
function addQuickContact() {
    const name = document.getElementById('qc-name').value.trim();
    const phone = document.getElementById('qc-phone').value.trim();
    if (!name) return;
    const list = document.getElementById('qc-list');
    const li = document.createElement('li');
    li.className = 'flex justify-between items-center border p-2 rounded';
    li.innerHTML = `<div><div class="font-medium">${escapeHtml(name)}</div><div class="text-xs text-gray-600">${escapeHtml(phone)}</div></div>`;
    const right = document.createElement('div');
    right.className = 'flex space-x-2';
    const call = document.createElement('a');
    call.href = phone ? `tel:${phone}` : '#';
    call.className = 'bg-red-500 text-white px-2 py-1 rounded text-sm';
    call.textContent = 'Call';
    const copy = document.createElement('button');
    copy.className = 'bg-gray-200 px-2 py-1 rounded text-sm';
    copy.textContent = 'Copy';
    copy.onclick = () => { copyTextToClipboard(`${name} ${phone}`); alert('Copied to clipboard'); };
    right.appendChild(call);
    right.appendChild(copy);
    li.appendChild(right);
    list.appendChild(li);
    document.getElementById('qc-name').value = '';
    document.getElementById('qc-phone').value = '';
}

function escapeHtml(s) {
    return s.replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[c]);
}
</script>
</body>
</html>